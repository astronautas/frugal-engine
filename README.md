Very messy implementation, WIP. Stay tuned!
